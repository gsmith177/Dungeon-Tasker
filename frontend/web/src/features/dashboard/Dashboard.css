/* Color tokens and Full viewport chain */
:root {
  /* 1. Background (under and between widgets) */
  --background: #442C22;

  /* 2. Widget background */
  --widget-bg: #634133;

  /* 3. Title text (main app title) */
  --title-text: #F0E7D8;

  /* 4. Widget title text */
  --widget-title: #F0E7D8;

  /* 5. Default text */
  --text: #AB9B96;

  /* 6/7. Button background & text (three options) */
  --btn-bg-1: #260C1A; --btn-text-1: #F0E7D8;
  --btn-bg-2: #777DA7; --btn-text-2: #F0E7D8;
  --btn-bg-3: #984447; --btn-text-3: #F0E7D8;

  /* 8. Slider color */
  --slider-color: #432E36;

  /* 9. Scrollbar colors */
  --scrollbar-bg: #260C1A;
  --scrollbar-thumb: #432E36;

  /* 10. Text entry field */
  --input-bg: #AB9B96;
  --input-placeholder: #432E36;
  --input-text: #260C1A;
}

html, body, #root, .app-root {
  margin: 0;
  padding: 0;
  height: 100vh;
  width: 100%;
  overflow: hidden;
  font-size: 16px; /* Base for rem calculations */
  background: var(--background);
  color: var(--text);
}

/* Ensure body stretches and becomes flex container */
body {
  display: flex;
  flex-direction: column;
}

/* Root and app-root stretch to fill viewport */
#root, .app-root {
  flex: 1;
  display: flex;
  width: 100%;
  height: 100%;
}

.dashboard-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); /* Dynamically fit columns based on available width */
  grid-template-rows: auto 1fr 1fr 1fr; /* Row 1 auto, rows 2-4 expand equally */
  gap: 0.5vh 0.5vw; /* Dynamic gap */
  flex: 1;
  width: 100%;
  padding: 0.5vh;
  box-sizing: border-box;
  background: transparent; /* show the root/background color between widgets */
  color: inherit;
}

.cell {
  background: var(--widget-bg);
  border: none;
  padding: 0.5rem;
  box-sizing: border-box;
  overflow: auto; /* allow the cell itself to scroll if content exceeds */
  display: flex;
  flex-direction: column;
  font-size: 0.875rem;
  min-height: 0; /* Critical: allows flex to shrink children below content size */
}

/* Direct wrapper div inside cell - must be flex container to control children */
.cell > div:first-child {
  display: flex;
  flex-direction: column;
  flex: 1;
  min-height: 0;
  min-width: 0; /* Critical: allows flex to shrink children below content size */
  overflow-y: visible;
  overflow-x: hidden;
}

/* Form elements always fit within cell bounds */
.cell input,
.cell textarea,
.cell button,
.cell select {
  box-sizing: border-box;
  max-width: 100%;
  min-width: 0; /* Prevent overflow with padding */
  font-size: 0.8125rem;
  padding: 0.25rem 0.35rem;
}

/* Standard spacing for widget elements */
.cell h2 {
  margin: 0 0 0.4rem 0;
  font-size: 1rem;
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
}

.cell h3 {
  margin: 0 0 0 0;
  font-size: 0.875rem;
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
}

.cell p,
.cell li {
  margin: 0 0;
  font-size: 0.8125rem;
  min-width: 0;
  word-wrap: break-word;
  overflow-wrap: break-word;
}

.cell input[type="text"],
.cell input[type="range"],
.cell textarea,
.cell button {
  width: 100%;
  min-width: 0;
  flex-shrink: 0;
}

.cell textarea {
  resize: vertical;
  min-height: 3rem;
  max-height: 5rem;
}

.cell button {
  margin-bottom: 0.25rem;
  padding: 0.2rem 0.4rem;
  height: 1.4rem;
}

.cell input[type="text"],
.cell input[type="password"],
.cell input[type="email"] {
  height: 1.625rem;
  margin-bottom: 0rem;
}

.cell input[type="range"] {
  margin-bottom: 0.35rem;
  height: 1.25rem;
}

.cell label {
  margin-bottom: 0.35rem;
  display: block;
  font-size: 0.8125rem;
}

.cell > div + div,
.cell > label + label {
  margin-top: 0.35rem;
}

/* Widget content wrapper - constrain to available space */
.widget-content {
  flex: 1;
  min-height: 0;
  min-width: 0;
  overflow-y: auto;
  overflow-x: hidden;
}

/* Graph preview matches input background and placeholder color */
.graph-preview {
  background: var(--input-bg);
  color: var(--input-placeholder);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.75rem;
  padding: 0.5rem;
  border-radius: 4px;
  min-height: 3rem;
}

/* Color mappings for titles, inputs, buttons, sliders, and scrollbars */
h1.app-title {
  color: var(--title-text);
}

.cell {
  color: var(--text);
}

.cell h2 {
  color: var(--widget-title);
}

/* Inputs/textareas */
.cell input,
.cell textarea {
  background: var(--input-bg);
  color: var(--input-text);
}
.cell select {
  background: var(--widget-bg);
  color: var(--text);
  border: 1px solid var(--btn-bg-1);
}
.cell input::placeholder,
.cell textarea::placeholder {
  color: var(--input-placeholder);
  opacity: 1;
}

/* Buttons - default and utility classes */
.cell button {
  background: var(--btn-bg-1);
  color: var(--btn-text-1);
  border: none;
  border-radius: 4px;
}
.btn-2 { background: var(--btn-bg-2); color: var(--btn-text-2); }
.btn-3 { background: var(--btn-bg-3); color: var(--btn-text-3); }

/* Slider styling */
input[type="range"] {
  -webkit-appearance: none;
  appearance: none;
  background: transparent;
}
input[type="range"]::-webkit-slider-runnable-track {
  height: 6px;
  background: rgba(0,0,0,0.12);
  border-radius: 999px;
}
input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  margin-top: -4px;
  width: 14px;
  height: 14px;
  border-radius: 50%;
  background: var(--slider-color);
}
input[type="range"]::-moz-range-track { background: rgba(0,0,0,0.12); height:6px; border-radius:999px; }
input[type="range"]::-moz-range-thumb { width:14px; height:14px; border-radius:50%; background:var(--slider-color); }

/* Scrollbar styling (WebKit) */
*::-webkit-scrollbar { width: 10px; height: 10px; }
*::-webkit-scrollbar-track { background: var(--scrollbar-bg); }
*::-webkit-scrollbar-thumb { background: var(--scrollbar-thumb); border-radius: 6px; }

/* Firefox scrollbar */
* { scrollbar-width: thin; scrollbar-color: var(--scrollbar-thumb) var(--scrollbar-bg); }

/* Row assignments - matches your screenshot */
.cell-header      { grid-row: 1; grid-column: 1 / span 2; }
.cell-audio       { grid-row: 1; grid-column: 3; }

.cell-music       { grid-row: 2; grid-column: 1; }
.cell-player-stats{ grid-row: 2; grid-column: 2; }
.cell-rules       { grid-row: 2; grid-column: 3; }

.cell-puzzles     { grid-row: 3; grid-column: 1; }
.cell-encounters  { grid-row: 3; grid-column: 2; }
.cell-encounter-maker { grid-row: 3; grid-column: 3; }

.cell-view-switcher { grid-row: 4; grid-column: 1; }
.cell-story         { grid-row: 4; grid-column: 2; }
.cell-story-graph   { grid-row: 4; grid-column: 3; }
